<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>ThreadJS API Reference</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg-primary: #f8f9fa;
      --bg-secondary: #ffffff;
      --panel: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);
      --text-primary: #1a1d20;
      --text-secondary: #495057;
      --border-light: #dee2e6;
      --border-medium: #adb5bd;
      --accent: #6c757d;
      --accent-hover: #495057;
      --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.08);
      --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.6;
    }

    header {
      padding: 1.25rem 2rem;
      background: var(--panel);
      border-bottom: 2px solid var(--border-medium);
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: var(--shadow-md);
    }

    header h1 {
      margin: 0;
      font-size: 1.5rem;
      font-weight: 700;
      letter-spacing: 0.5px;
      background: linear-gradient(135deg, #495057 0%, #6c757d 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    header h1::before { content: "âš¡"; font-size: 1.75rem; -webkit-text-fill-color: #6c757d; }

    nav { display: flex; gap: 0.75rem; }

    nav a {
      color: var(--text-primary);
      text-decoration: none;
      font-size: 0.95rem;
      font-weight: 500;
      padding: 0.6rem 1.2rem;
      border-radius: 8px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-light);
      box-shadow: var(--shadow-sm);
      transition: all 0.2s ease;
      position: relative;
      overflow: hidden;
    }

    nav a:hover { background: var(--accent); color: white; border-color: var(--accent-hover); transform: translateY(-1px); box-shadow: var(--shadow-md); }
    nav a[href="index.html"], nav a[href="./"] { background: var(--accent); color: white; border-color: var(--accent-hover); }

    #redoc-container {
      height: calc(100vh - 70px);
      background: var(--bg-secondary);
      box-shadow: inset 0 4px 6px rgba(0, 0, 0, 0.03);
      position: relative;
    }

    .redoc-wrap { background: var(--bg-secondary) !important; }

    /* Loading overlay only while .loading is present */
    #redoc-container.loading::before {
      content: "Loading API Documentation...";
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.1rem;
      color: var(--text-secondary);
      background: var(--bg-secondary);
      z-index: 2;
      animation: pulse 1.5s ease-in-out infinite;
    }

    @keyframes pulse { 0%,100% { opacity: 0.6; } 50% { opacity: 1; } }

    @media (max-width: 768px) {
      header { flex-direction: column; gap: 1rem; padding: 1rem; }
      header h1 { font-size: 1.25rem; }
      nav { width: 100%; justify-content: center; }
      nav a { flex: 1; text-align: center; padding: 0.5rem 0.8rem; font-size: 0.875rem; }
      #redoc-container { height: calc(100vh - 130px); }
    }

    ::-webkit-scrollbar { width: 10px; height: 10px; }
    ::-webkit-scrollbar-track { background: var(--bg-primary); }
    ::-webkit-scrollbar-thumb { background: var(--border-medium); border-radius: 5px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--accent); }
  </style>

  <script src="https://cdn.redoc.ly/redoc/latest/bundles/redoc.standalone.js"></script>
</head>
<body>
  <header>
    <h1>ThreadJS API Reference</h1>
    <nav>
      <a href="index.html">ðŸ“š API Reference</a>
    </nav>
  </header>

  <div id="redoc-container" class="loading"></div>

  <script>
    (function() {
      var container = document.getElementById("redoc-container");
      var specUrl = "openapi.yaml"; // relative to docs/

      function onLoaded() {
        container.classList.remove("loading");
      }

      // Initialize Redoc and remove loading state when done
      try {
        Redoc.init(
          specUrl,
          {
            theme: {
              colors: {
                primary: { main: "#6c757d" },
                text: { primary: "#1a1d20", secondary: "#495057" },
                http: { get: "#10b981", post: "#3b82f6", put: "#f59e0b", delete: "#ef4444", patch: "#8b5cf6" },
                border: { dark: "#adb5bd", light: "#dee2e6" }
              },
              sidebar: { backgroundColor: "#f8f9fa", textColor: "#1a1d20", activeTextColor: "#495057", groupItems: { activeBackgroundColor: "#e9ecef" } },
              rightPanel: { backgroundColor: "#212529", textColor: "#f8f9fa" },
              typography: {
                fontFamily: "-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif",
                fontSize: "15px",
                lineHeight: "1.6",
                headings: { fontFamily: "-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif", fontWeight: "600" },
                code: { fontFamily: "'Fira Code', 'Courier New', monospace", fontSize: "14px" }
              }
            },
            scrollYOffset: 70,
            hideDownloadButton: false,
            disableSearch: false,
            expandResponses: "200,201",
            jsonSampleExpandLevel: 2,
            hideSingleRequestSampleTab: true,
            menuToggle: true,
            nativeScrollbars: false,
            pathInMiddlePanel: true,
            requiredPropsFirst: true,
            sortPropsAlphabetically: false,
            expandDefaultServerVariables: true
          },
          container,
          onLoaded
        );

        // Safety net: if Redoc fails silently (e.g. missing spec), show an error after 5s
        setTimeout(function() {
          if (container.classList.contains('loading')) {
            container.classList.remove('loading');
            container.innerHTML = '<div style="padding:1rem;color:#b91c1c;">Failed to load openapi.yaml. Ensure it is available at <code>docs/openapi.yaml</code> (GitHub Pages docs folder) or fix the path.</div>';
          }
        }, 5000);
      } catch (e) {
        container.classList.remove('loading');
        container.innerHTML = '<div style="padding:1rem;color:#b91c1c;">Error initializing Redoc: ' + String(e) + '</div>';
      }
    })();
  </script>
</body>
</html>
