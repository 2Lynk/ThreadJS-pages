openapi: 3.0.3
info:
  title: ThreadJS API Reference
  version: 1.0.0
  description: |
    **ThreadJS** Reference

tags:
  - name: Quickstart
  - name: Core
  - name: Messaging
  - name: Commands
  - name: Mods
  - name: Events
  - name: World
  - name: Players
  - name: Entities
  - name: Data
  - name: Scheduling
  - name: Debug

paths:
  #################
  ##   QUICKSTART
  #################
  /quickstart:
    tags: [Quickstart]
    summary: Getting started with ThreadJS
    description: |
      ## Setup Tutorial

      1. Install Fabric Loader and Fabric API for your Minecraft version.  
      2. Drop the ThreadJS mod jar into your `mods` folder.  
      3. Start the game/server once to generate the `/jsmods` directory.  
      4. Create a new file in `/jsmods/`, e.g. `hello.js`.  
      5. Use `/threadjs reload` in-game or in the console to hot-reload scripts.  
      6. Make yourself an operator to run admin commands and test features.

      Anything that the mod should do while running you declare inside of the  ```onInitialize(api) { ... } ``` function. 
      This is the main functinon of the mod.
    x-codeSamples:
      - lang: JavaScript
        label: hello.js â€“ first script
        source: |
          // /jsmods/hello.js
          api.registerMod("hello", {
            onInitialize(api) {
              api.log("Hello from ThreadJS!");

              api.onPlayerJoin(player => {
                api.sendMessage(`Welcome ${player.name}!`);
              });
            }
          });

  #################
  ##   Inspector
  #################
  /quickstart/inspector:
    summary: Using the Inspector
    tags: [Quickstart]
    description: |
      ## Debugging with the ThreadJS Inspector

      ThreadJS comes with a built-in **Inspector** available directly on the documentation website.
      It helps you debug scripts, test API calls, view object data, and understand what functions
      return â€” without needing to go in-game constantly.

      ### ðŸ” Opening the Inspector
      At the top of this documentation page, click:

      **ðŸ§ª Inspector**

      This opens a live console powered by the ThreadJS runtime.

      ### ðŸ“ 1. Logging values with `api.log()`
      Use `api.log()` to print simple values:

      ```javascript
      api.log("Hello from my mod!");
      api.log(42);
      api.log({ foo: "bar", active: true });
      ```

      Logs appear immediately inside the Inspector console.

      ### ðŸ§  2. Inspecting complex objects
      When debugging player data, entities, events, or world state, use:

      ```javascript
      api.debug.describe(value)
      ```

      or the more detailed version:

      ```javascript
      api.debug.inspect(value)
      ```

      **Examples:**

      ```javascript
      const players = api.players.list();
      api.debug.describe(players[0]); // short, readable summary

      api.debug.inspect(players[0]);  // full deep object view
      ```

      `inspect()` is perfect for exploring what fields exist on objects such as:

      - `PlayerState`
      - entity objects
      - event objects (block break, chat messages, etc.)
      - world block data

      ### â±ï¸ 3. Inspecting values during events
      You can drop inspection calls into event listeners:

      ```javascript
      api.onPlayerJoin(player => {
        api.debug.inspect(player);
      });
      ```

      When a player joins the server, the Inspector logs the entire object structure.

      ### ðŸ§¨ 4. Triggering a breakpoint in the Inspector (optional)
      If you want the Inspector to pause and highlight a moment:

      ```javascript
      api.debug.breakpoint();
      ```

      Example:

      ```javascript
      api.onChatMessage(evt => {
        if (evt.message.includes("secret")) {
          api.debug.breakpoint();
        }
      });
      ```

      This is useful for tracking down unexpected behavior.

      ### ðŸŽ¯ Summary

      - Use **Inspector** to debug without restarting your server.
      - Use **`api.log()`** for quick values.
      - Use **`api.debug.describe()`** for readable summaries.
      - Use **`api.debug.inspect()`** for deep inspection.
      - Use **`api.debug.breakpoint()`** to pause execution inside the Inspector.

      Combine these tools to understand exactly how ThreadJS data works.


   #################
  ##   CORE
  #################
  /api/log:
    tags: [Core]
    summary: api.log(message)
    description: |
      Logs any value to the server console.

      - `message` can be a string, number or object.
      - Objects are pretty-printed for easier debugging.
    x-codeSamples:
      - lang: JavaScript
        label: Basic logging
        source: |
          api.log("Hello from ThreadJS!");
          api.log({ foo: "bar", online: api.players.list().length });
          api.log(42);

  /api/scriptsDir:
    tags: [Core]
    summary: api.scriptsDir()
    description: |
      Returns the absolute path of the `/jsmods/` folder where ThreadJS looks
      for your scripts.
    x-codeSamples:
      - lang: JavaScript
        label: Print the scripts directory
        source: |
          const dir = api.scriptsDir();
          api.log(`Scripts are loaded from: ${dir}`);

  #################
  ##   MESSAGING
  #################

  /api/sendMessage:
    tags: [Messaging]
    summary: api.sendMessage(message)
    description: |
      Sends a chat message to **all players** on the server.
    x-codeSamples:
      - lang: JavaScript
        label: Broadcast restart warning
        source: |
          api.sendMessage("Server restart in 5 minutes!");
          api.sendMessage("Welcome to the ThreadJS test server.");

  /api/sendMessageTo:
    tags: [Messaging]
    summary: api.sendMessageTo(playerName, message)
    description: |
      Sends a private chat message to a single player by name.
    x-codeSamples:
      - lang: JavaScript
        label: Whisper to a player
        source: |
          api.sendMessageTo("Steve", "You found a secret room ðŸ‘€");
          api.sendMessageTo("Alex", "PvP is disabled in this area.");

  #################
  ##   COMMANDS
  #################

  /api/registerCommand:
    tags: [Commands]
    summary: api.registerCommand(name, handler, minPermissionLevel?, playerOnly?, argSpec?)
    description: |
      Registers a custom command that can be executed in chat.

      **Parameters**

      - `name` â€“ command name (without `/`).
      - `handler(ctx, args)` â€“ function called when the command runs.
      - `minPermissionLevel` â€“ Minecraft permission level (0â€“4), default `0`.
      - `playerOnly` â€“ if `true`, console cannot run this command.
      - `argSpec` â€“ optional array of tab-completion hints (`"player"`, `"int"`, etc).
    x-codeSamples:
      - lang: JavaScript
        label: Simple /js ping
        source: |
          api.registerCommand("ping", (ctx, args) => {
            ctx.reply("Pong!");
          });

      - lang: JavaScript
        label: Heal command for ops
        source: |
          api.registerCommand(
            "heal",
            (ctx, args) => {
              const [targetName, amountStr] = args;
              const amount = Number(amountStr) || 10;
              api.players.heal(targetName, amount);
              ctx.reply(`Healed ${targetName} for ${amount} HP`);
            },
            2,          // minPermissionLevel (ops+)
            true,       // playerOnly
            ["player", "int"]
          );

  #################
  ##   MODS
  #################

  /api/registerMod:
    tags: [Mods]
    summary: api.registerMod(id, module)
    description: |
      Registers a JavaScript "mod module" with optional lifecycle hooks.

      - `id` â€“ unique string ID for your mod.
      - `module.onInitialize(api)` â€“ called when the server starts.
      - `module.onReload(api)` â€“ called when `/threadjs reload` runs.
    x-codeSamples:
      - lang: JavaScript
        label: Simple mod module
        source: |
          api.registerMod("hello-mod", {
            onInitialize(api) {
              api.log("[hello-mod] initialized");
              api.sendMessage("hello-mod is now live!");
            },
            onReload(api) {
              api.log("[hello-mod] reloaded");
            }
          });

  #################
  ##   EVENTS
  #################

  /api/events/serverTick:
    tags: [Events]
    summary: api.onServerTick(callback)
    description: |
      Runs `callback()` every server tick (~20 times per second).
    x-codeSamples:
      - lang: JavaScript
        label: Simple tick counter
        source: |
          let ticks = 0;
          api.onServerTick(() => {
            ticks++;
            if (ticks % 200 === 0) {
              api.log(`Server has ticked ${ticks} times`);
            }
          });

  /api/events/playerJoin:
    tags: [Events]
    summary: api.onPlayerJoin(callback)
    description: |
      Runs `callback(player)` whenever a player joins the server.
    x-codeSamples:
      - lang: JavaScript
        label: Welcome message
        source: |
          api.onPlayerJoin(player => {
            api.sendMessage(`âœ¨ ${player.name} joined the server!`);
          });

  /api/events/playerLeave:
    tags: [Events]
    summary: api.onPlayerLeave(callback)
    description: |
      Runs `callback(player)` whenever a player leaves the server.
    x-codeSamples:
      - lang: JavaScript
        label: Goodbye log
        source: |
          api.onPlayerLeave(player => {
            api.log(`${player.name} left the game`);
          });

  /api/events/playerTick:
    tags: [Events]
    summary: api.onPlayerTick(callback)
    description: |
      Runs `callback(player)` every tick for each online player.
    x-codeSamples:
      - lang: JavaScript
        label: Give slow regeneration aura
        source: |
          api.onPlayerTick(player => {
            // Example: heal a tiny amount every 2 seconds
            if (player.tick % 40 === 0) {
              api.players.heal(player.name, 0.5);
            }
          });

  /api/events/chatMessage:
    tags: [Events]
    summary: api.onChatMessage(callback)
    description: |
      Runs `callback({ player, message })` whenever someone sends a chat message.
    x-codeSamples:
      - lang: JavaScript
        label: Simple chat filter
        source: |
          const banned = ["badword1", "badword2"];

          api.onChatMessage(evt => {
            if (banned.some(w => evt.message.includes(w))) {
              api.sendMessageTo(evt.player.name, "Watch your language!");
              evt.cancel && evt.cancel(); // if supported
            }
          });

  /api/events/blockBreak:
    tags: [Events]
    summary: api.onBlockBreak(callback)
    description: |
      Runs `callback(event)` whenever a player breaks a block.
    x-codeSamples:
      - lang: JavaScript
        label: Protect spawn region
        source: |
          api.onBlockBreak(evt => {
            if (evt.x < 32 && evt.z < 32 && evt.x > -32 && evt.z > -32) {
              api.sendMessageTo(evt.playerName, "You cannot break blocks at spawn.");
              evt.cancel && evt.cancel();
            }
          });

  /api/events/blockPlace:
    tags: [Events]
    summary: api.onBlockPlace(callback)
    description: |
      Runs `callback(event)` whenever a player places a block.
    x-codeSamples:
      - lang: JavaScript
        label: Log TNT placements
        source: |
          api.onBlockPlace(evt => {
            if (evt.blockId === "minecraft:tnt") {
              api.log(`${evt.playerName} placed TNT at ${evt.x}, ${evt.y}, ${evt.z}`);
            }
          });

  /api/events/useBlock:
    tags: [Events]
    summary: api.onUseBlock(callback)
    description: |
      Runs `callback(event)` whenever a player right-clicks a block.
    x-codeSamples:
      - lang: JavaScript
        label: Open custom menu on chest
        source: |
          api.onUseBlock(evt => {
            if (evt.blockId === "minecraft:chest") {
              api.sendMessageTo(evt.playerName, "You opened a special chest!");
            }
          });

  /api/events/useItem:
    tags: [Events]
    summary: api.onUseItem(callback)
    description: |
      Runs `callback(event)` whenever a player uses an item.
    x-codeSamples:
      - lang: JavaScript
        label: Magic stick
        source: |
          api.onUseItem(evt => {
            if (evt.itemId === "minecraft:stick") {
              api.sendMessageTo(evt.playerName, "Bonk!");
            }
          });

  /api/events/attackEntity:
    tags: [Events]
    summary: api.onAttackEntity(callback)
    description: |
      Runs `callback(event)` whenever a player attacks an entity.
    x-codeSamples:
      - lang: JavaScript
        label: No friendly fire
        source: |
          api.onAttackEntity(evt => {
            if (evt.targetType === "PLAYER") {
              evt.cancel && evt.cancel();
              api.sendMessageTo(evt.playerName, "Friendly fire is disabled.");
            }
          });

  /api/events/entityDamage:
    tags: [Events]
    summary: api.onEntityDamage(callback)
    description: |
      Runs `callback(event)` whenever any entity takes damage.
    x-codeSamples:
      - lang: JavaScript
        label: Log fall damage
        source: |
          api.onEntityDamage(evt => {
            if (evt.sourceType === "FALL") {
              api.log(`Fall damage: ${evt.amount} on ${evt.victimType}`);
            }
          });

  /api/events/entityDeath:
    tags: [Events]
    summary: api.onEntityDeath(callback)
    description: |
      Runs `callback(event)` whenever any entity dies.
    x-codeSamples:
      - lang: JavaScript
        label: Kill feed
        source: |
          api.onEntityDeath(evt => {
            if (evt.killedBy) {
              api.sendMessage(`${evt.killedBy} killed ${evt.victimName || evt.victimType}`);
            }
          });

  #################
  ##   WORLD
  #################

  /api/world/setBlock:
    tags: [World]
    summary: api.world.setBlock(x, y, z, dimensionId, blockId)
    description: |
      Sets a single block at the given position.
    x-codeSamples:
      - lang: JavaScript
        label: Place a diamond block at spawn
        source: |
          api.world.setBlock(0, 64, 0, "minecraft:overworld", "minecraft:diamond_block");

  /api/world/getBlock:
    tags: [World]
    summary: api.world.getBlock(x, y, z, dimensionId)
    description: |
      Returns information about the block at a given position.
    x-codeSamples:
      - lang: JavaScript
        label: Check block type
        source: |
          const block = api.world.getBlock(0, 64, 0, "minecraft:overworld");
          api.log(`Block at spawn: ${block.blockId}`);

  /api/world/fillArea:
    tags: [World]
    summary: api.world.fillArea(x1, y1, z1, x2, y2, z2, dimensionId, blockId)
    description: |
      Fills a rectangular area with a single block type.
    x-codeSamples:
      - lang: JavaScript
        label: Create glass box
        source: |
          api.world.fillArea(-5, 60, -5, 5, 70, 5, "minecraft:overworld", "minecraft:glass");

  /api/world/replaceBlocks:
    tags: [World]
    summary: api.world.replaceBlocks(x1, y1, z1, x2, y2, z2, dimensionId, fromBlockId, toBlockId)
    description: |
      Replaces all matching blocks in an area with another block type.
    x-codeSamples:
      - lang: JavaScript
        label: Turn all dirt into grass
        source: |
          api.world.replaceBlocks(
            -64, 40, -64,
            64, 80, 64,
            "minecraft:overworld",
            "minecraft:dirt",
            "minecraft:grass_block"
          );

  #################
  ##   PLAYERS
  #################

  /api/players/list:
    tags: [Players]
    summary: api.players.list()
    description: |
      Returns an array of `PlayerState` objects for all online players.
    x-codeSamples:
      - lang: JavaScript
        label: Log all player names
        source: |
          const players = api.players.list();
          players.forEach(p => api.log(`Online: ${p.name}`));

  /api/players/teleport:
    tags: [Players]
    summary: api.players.teleport(playerName, x, y, z, dimensionId)
    description: |
      Teleports a player by name to a new position.
    x-codeSamples:
      - lang: JavaScript
        label: Send Steve to spawn
        source: |
          api.players.teleport("Steve", 0, 70, 0, "minecraft:overworld");

  /api/players/setGamemode:
    tags: [Players]
    summary: api.players.setGamemode(playerName, mode)
    description: |
      Sets a player's gamemode.

      - `mode` is one of `SURVIVAL`, `CREATIVE`, `ADVENTURE`, `SPECTATOR`.
    x-codeSamples:
      - lang: JavaScript
        label: Switch to creative
        source: |
          api.players.setGamemode("Steve", "CREATIVE");

  /api/players/setHealth:
    tags: [Players]
    summary: api.players.setHealth(playerName, health)
    description: |
      Sets a player's health to an exact value.
    x-codeSamples:
      - lang: JavaScript
        label: Set full health
        source: |
          api.players.setHealth("Steve", 20);

  /api/players/heal:
    tags: [Players]
    summary: api.players.heal(playerName, amount)
    description: |
      Heals a player by a certain amount.
    x-codeSamples:
      - lang: JavaScript
        label: Heal on command
        source: |
          api.players.heal("Steve", 5);

  /api/players/giveItem:
    tags: [Players]
    summary: api.players.giveItem(playerName, itemId, count)
    description: |
      Gives an item to the player's inventory.
    x-codeSamples:
      - lang: JavaScript
        label: Give diamond sword
        source: |
          api.players.giveItem("Steve", "minecraft:diamond_sword", 1);

  /api/players/playerSetPos:
    tags: [Players]
    summary: api.players.setPos(playerState, x, y, z)
    description: |
      Sets the position on a `PlayerState` object (advanced usage).
    x-codeSamples:
      - lang: JavaScript
        label: Offset all players upwards
        source: |
          api.players.list().forEach(p => {
            api.players.setPos(p, p.pos[0], p.pos[1] + 5, p.pos[2]);
          });

  /api/players/playerTeleport:
    tags: [Players]
    summary: api.players.teleportState(playerState, x, y, z, dimensionId)
    description: |
      Teleports a `PlayerState` object.
    x-codeSamples:
      - lang: JavaScript
        label: Teleport using PlayerState
        source: |
          api.players.list().forEach(p => {
            api.players.teleportState(p, 0, 80, 0, p.dimensionId);
          });

  /api/players/playerSetHealth:
    tags: [Players]
    summary: api.players.setHealthState(playerState, health)
    description: |
      Sets health on a `PlayerState` object.
    x-codeSamples:
      - lang: JavaScript
        label: Set everyone to half health
        source: |
          api.players.list().forEach(p => {
            api.players.setHealthState(p, p.maxHealth / 2);
          });

  /api/players/playerHeal:
    tags: [Players]
    summary: api.players.healState(playerState, amount)
    description: |
      Heals a `PlayerState` by a certain amount.
    x-codeSamples:
      - lang: JavaScript
        label: Regen aura
        source: |
          api.onServerTick(() => {
            api.players.list().forEach(p => {
              api.players.healState(p, 0.1);
            });
          });

  /api/players/playerSetGamemode:
    tags: [Players]
    summary: api.players.setGamemodeState(playerState, mode)
    description: |
      Sets gamemode on a `PlayerState` object.
    x-codeSamples:
      - lang: JavaScript
        label: Spectator all players
        source: |
          api.players.list().forEach(p => {
            api.players.setGamemodeState(p, "SPECTATOR");
          });

  /api/players/playerGiveItem:
    tags: [Players]
    summary: api.players.giveItemState(playerState, itemId, count)
    description: |
      Gives an item to a `PlayerState`'s inventory.
    x-codeSamples:
      - lang: JavaScript
        label: Give everyone cookies
        source: |
          api.players.list().forEach(p => {
            api.players.giveItemState(p, "minecraft:cookie", 16);
          });

  /api/players/playerEquipArmor:
    tags: [Players]
    summary: api.players.equipArmor(playerState, armorSpec)
    description: |
      Equips armor on a `PlayerState`.

      `armorSpec` has optional `helmet`, `chestplate`, `leggings`, `boots` item IDs.
    x-codeSamples:
      - lang: JavaScript
        label: Full diamond armor
        source: |
          api.players.list().forEach(p => {
            api.players.equipArmor(p, {
              helmet: "minecraft:diamond_helmet",
              chestplate: "minecraft:diamond_chestplate",
              leggings: "minecraft:diamond_leggings",
              boots: "minecraft:diamond_boots"
            });
          });

  #################
  ##   ENTITIES
  #################

  /api/entities/spawn:
    tags: [Entities]
    summary: api.entities.spawn(entityTypeId, x, y, z, dimensionId)
    description: |
      Spawns a new entity and returns its UUID.
    x-codeSamples:
      - lang: JavaScript
        label: Spawn a cow at spawn
        source: |
          const cowId = api.entities.spawn("minecraft:cow", 0, 64, 0, "minecraft:overworld");
          api.log(`Spawned cow with UUID ${cowId}`);

  /api/entities/kill:
    tags: [Entities]
    summary: api.entities.kill(entityUuid)
    description: |
      Kills an entity by UUID.
    x-codeSamples:
      - lang: JavaScript
        label: Remove an entity
        source: |
          const zombieId = api.entities.spawn("minecraft:zombie", 0, 64, 5, "minecraft:overworld");
          api.entities.kill(zombieId);

  /api/entities/find:
    tags: [Entities]
    summary: api.entities.find(options)
    description: |
      Finds entities around a point.

      `options` can include:

      - `typeId` â€“ optional entity type filter.
      - `center` â€“ `{ x, y, z, dimensionId }`.
      - `radius` â€“ search radius (default `16`).
    x-codeSamples:
      - lang: JavaScript
        label: Count nearby mobs
        source: |
          const center = { x: 0, y: 64, z: 0, dimensionId: "minecraft:overworld" };
          const mobs = api.entities.find({ center, radius: 32 });
          api.log(`There are ${mobs.length} entities near spawn`);

  #################
  ##   DATA
  #################

  /api/data/load:
    tags: [Data]
    summary: api.data.load(namespace, key)
    description: |
      Loads previously saved data for a given namespace/key pair.

      Returns `undefined` or `null` if not found.
    x-codeSamples:
      - lang: JavaScript
        label: Load player stats
        source: |
          const stats = api.data.load("stats", "Steve") || { kills: 0, deaths: 0 };
          api.log(`Steve has ${stats.kills} kills and ${stats.deaths} deaths`);

  /api/data/save:
    tags: [Data]
    summary: api.data.save(namespace, key, value)
    description: |
      Saves arbitrary JSON-serializable data.
    x-codeSamples:
      - lang: JavaScript
        label: Save player stats
        source: |
          api.data.save("stats", "Steve", {
            kills: 10,
            deaths: 2
          });

  #################
  ##   SCHEDULING
  #################

  /api/scheduling/runLater:
    tags: [Scheduling]
    summary: api.scheduling.runLater(ticks, callback)
    description: |
      Runs `callback()` once after the given number of ticks.
    x-codeSamples:
      - lang: JavaScript
        label: One-shot timer
        source: |
          api.scheduling.runLater(100, () => {
            api.sendMessage("100 ticks have passed!");
          });

  /api/scheduling/runRepeating:
    tags: [Scheduling]
    summary: api.scheduling.runRepeating(intervalTicks, callback)
    description: |
      Runs `callback()` repeatedly every `intervalTicks`.
    x-codeSamples:
      - lang: JavaScript
        label: Repeating announcement
        source: |
          api.scheduling.runRepeating(20 * 60, () => {
            api.sendMessage("Remember to join our Discord!");
          });

  #################
  ##   DEBUG
  #################

  /api/debug/inspect:
    tags: [Debug]
    summary: api.debug.inspect(obj)
    description: |
      Logs a detailed, structured view of an object for debugging.
    x-codeSamples:
      - lang: JavaScript
        label: Inspect PlayerState
        source: |
          const player = api.players.list()[0];
          api.debug.inspect(player);

  /api/debug/describe:
    tags: [Debug]
    summary: api.debug.describe(obj)
    description: |
      Logs a shorter, human-friendly description of an object.
    x-codeSamples:
      - lang: JavaScript
        label: Describe PlayerState
        source: |
          const player = api.players.list()[0];
          api.debug.describe(player);

  /api/debug/breakpoint:
    tags: [Debug]
    summary: api.debug.breakpoint()
    description: |
      Triggers a breakpoint inside the ThreadJS debugger (if attached).
    x-codeSamples:
      - lang: JavaScript
        label: Conditional breakpoint
        source: |
          api.onPlayerJoin(player => {
            if (player.name === "Steve") {
              api.debug.breakpoint();
            }
          });

  /api/debug/setDebugLocal:
    tags: [Debug]
    summary: api.debug.setDebugLocal(options)
    description: |
      Configures where debug output is sent.

      `options` can include:

      - `debugLocal` â€“ enable/disable local debug mode.
      - `logToPlayer` â€“ mirror logs to a player.
      - `playerName` â€“ target player name.
    x-codeSamples:
      - lang: JavaScript
        label: Send debug output to a player
        source: |
          api.debug.setDebugLocal({
            debugLocal: true,
            logToPlayer: true,
            playerName: "Steve"
          });

  /api/debug/startDebugger:
    tags: [Debug]
    summary: api.debug.startDebugger(port?)
    description: |
      Starts the ThreadJS WebSocket debugger on the given port (default `31337`).
    x-codeSamples:
      - lang: JavaScript
        label: Default port
        source: |
          api.debug.startDebugger();

      - lang: JavaScript
        label: Custom port
        source: |
          api.debug.startDebugger(40000);
